---
title: "Midterm Project"
author: 'Christopher Flores and Zack Chipperfield'
output:
  word_document: default
---

```{r}
library(tidyverse)
```


```{r, read_data}
data_url <- 'https://raw.githubusercontent.com/florescss14/STAT1341_Midterm_Project/main/Bundesliga.csv'
bund <- readr::read_csv(data_url, col_names = TRUE)

data_url <- 'https://raw.githubusercontent.com/florescss14/STAT1341_Midterm_Project/main/La_Liga.csv'
liga <- readr::read_csv(data_url, col_names = TRUE)

data_url <- 'https://raw.githubusercontent.com/florescss14/STAT1341_Midterm_Project/main/Ligue_1.csv'
ligue <- readr::read_csv(data_url, col_names = TRUE)

data_url <- 'https://raw.githubusercontent.com/florescss14/STAT1341_Midterm_Project/main/Premier_League.csv'
epl <- readr::read_csv(data_url, col_names = TRUE)

data_url <- 'https://raw.githubusercontent.com/florescss14/STAT1341_Midterm_Project/main/Serie_A.csv'
serie <- readr::read_csv(data_url, col_names = TRUE)

all <- rbind(bund, liga, ligue, epl, serie)
```

```{r}
ggplot() +
geom_histogram(mapping = aes(x = bund$Total_Cmp_Pct), bins = 8) 

ggplot() +
geom_histogram(mapping = aes(x = liga$Total_Cmp_Pct), bins = 8) 

ggplot() +
  geom_histogram(mapping = aes(x = ligue$Total_Cmp_Pct), bins = 8)
ggplot() +
  geom_histogram(mapping = aes(x = epl$Total_Cmp_Pct), bins = 8)
ggplot() +
  geom_histogram(mapping = aes(x = serie$Total_Cmp_Pct), bins = 8)
```

```{r}
mean(bund$Total_Cmp_Pct)
mean(liga$Total_Cmp_Pct)
mean(ligue$Total_Cmp_Pct)
mean(epl$Total_Cmp_Pct) 
mean(serie$Total_Cmp_Pct)
```
```{r}
sd(bund$Total_Cmp_Pct)
sd(liga$Total_Cmp_Pct)
sd(ligue$Total_Cmp_Pct)
sd(epl$Total_Cmp_Pct) 
sd(serie$Total_Cmp_Pct)
```

```{r}
plot(bund$Total_Cmp_Pct, bund$Pts)
plot(liga$Total_Cmp_Pct, liga$Pts)
plot(ligue$Total_Cmp_Pct, ligue$Pts)
plot(epl$Total_Cmp_Pct, epl$Pts)
plot(serie$Total_Cmp_Pct, serie$Pts)
```
Let's look at the correlation between Passing completion and points for each league.

```{r}

cor(bund$Total_Cmp_Pct, bund$Pts)
cor(liga$Total_Cmp_Pct, liga$Pts)
cor(ligue$Total_Cmp_Pct, ligue$Pts)
cor(epl$Total_Cmp_Pct, epl$Pts)
cor(serie$Total_Cmp_Pct, serie$Pts)
```
```{r}
plot(bund$PrgDist, bund$Pts)
plot(liga$PrgDist, liga$Pts)
plot(ligue$PrgDist, ligue$Pts)
plot(epl$PrgDist, epl$Pts)
plot(serie$PrgDist, serie$Pts)
```

```{r}
cor(bund$PrgDist, bund$Pts)
cor(liga$PrgDist, liga$Pts)
cor(ligue$PrgDist, ligue$Pts)
cor(epl$PrgDist, epl$Pts)
cor(serie$PrgDist, serie$Pts)
```
```{r}
plot(bund$Prog_10_plus_yards, bund$Pts)
plot(liga$Prog_10_plus_yards, liga$Pts)
plot(ligue$Prog_10_plus_yards, ligue$Pts)
plot(epl$Prog_10_plus_yards, epl$Pts)
plot(serie$Prog_10_plus_yards, serie$Pts)
```

```{r}
cor(bund$Prog_10_plus_yards, bund$Pts)
cor(liga$Prog_10_plus_yards, liga$Pts)
cor(ligue$Prog_10_plus_yards, ligue$Pts)
cor(epl$Prog_10_plus_yards, epl$Pts)
cor(serie$Prog_10_plus_yards, serie$Pts)
```

```{r}
plot(bund$Short_Cmp_Pct, bund$Pts)
plot(liga$Short_Cmp_Pct, liga$Pts)
plot(ligue$Short_Cmp_Pct, ligue$Pts)
plot(epl$Short_Cmp_Pct, epl$Pts)
plot(serie$Short_Cmp_Pct, serie$Pts)
```
```{r}
cor(bund$Short_Cmp_Pct, bund$Pts)
cor(liga$Short_Cmp_Pct, liga$Pts)
cor(ligue$Short_Cmp_Pct, ligue$Pts)
cor(epl$Short_Cmp_Pct, epl$Pts)
cor(serie$Short_Cmp_Pct, serie$Pts)
```
```{r}
plot(bund$Medium_Cmp_Pct, bund$Pts)
plot(liga$Medium_Cmp_Pct, liga$Pts)
plot(ligue$Medium_Cmp_Pct, ligue$Pts)
plot(epl$Medium_Cmp_Pct, epl$Pts)
plot(serie$Medium_Cmp_Pct, serie$Pts)
```
```{r}
cor(bund$Medium_Cmp_Pct, bund$Pts)
cor(liga$Medium_Cmp_Pct, liga$Pts)
cor(ligue$Medium_Cmp_Pct, ligue$Pts)
cor(epl$Medium_Cmp_Pct, epl$Pts)
cor(serie$Medium_Cmp_Pct, serie$Pts)
```
```{r}
plot(bund$Long_Cmp_Pct, bund$Pts)
plot(liga$Long_Cmp_Pct, liga$Pts)
plot(ligue$Long_Cmp_Pct, ligue$Pts)
plot(epl$Long_Cmp_Pct, epl$Pts)
plot(serie$Long_Cmp_Pct, serie$Pts)
```
```{r}
cor(bund$Long_Cmp_Pct, bund$Pts)
cor(liga$Long_Cmp_Pct, liga$Pts)
cor(ligue$Long_Cmp_Pct, ligue$Pts)
cor(epl$Long_Cmp_Pct, epl$Pts)
cor(serie$Long_Cmp_Pct, serie$Pts)
```

```{r}
cor(bund$TotDist, bund$Pts)
cor(liga$TotDist, liga$Pts)
cor(ligue$TotDist, ligue$Pts)
cor(epl$TotDist, epl$Pts)
cor(serie$TotDist, serie$Pts)
```
```{r}
multi_model <- lm( Pts ~ Total_Cmp_Pct + PrgDist + Short_Cmp_Pct + Medium_Cmp_Pct + Long_Cmp_Pct + Prog_10_plus_yards, data = all)
summary(multi_model)
```
```{r}
all$pred <- predict(multi_model, all)
all$error <- all$Pts - all$pred
```










